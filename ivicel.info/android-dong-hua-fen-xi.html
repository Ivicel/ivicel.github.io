<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Android 动画分析</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
  <link href="./" rel="canonical" />

  <!-- Feed -->

  <link href="./theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="./theme/css/code_blocks/github.css" rel="stylesheet">

    <!-- CSS specified by the user -->


    <link href="./assets/css/prism.css" type="text/css" rel="stylesheet" />


    <link href="./assets/css/base.css" type="text/css" rel="stylesheet" />


    <link href="./assets/css/base-control.css" type="text/css" rel="stylesheet" />


    <link href="./assets/css/github.css" type="text/css" rel="stylesheet" />


    <link href="./assets/css/codemirror.css" type="text/css" rel="stylesheet" />


    <link href="./assets/css/ivicel.css" type="text/css" rel="stylesheet" />

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->


  <link href="./android-dong-hua-fen-xi.html" rel="canonical" />

    <meta name="description" content="Android 的动画分为以下两类 : View 动画 补间动画 (Tween Animation, Animation 类及其子类 ): 通过对 view 不断的作 rotate, scale, translate 等一系列操作从而达到动画效果 , xml 文件放在...">

    <meta name="author" content="ivicel">

    <meta name="tags" content="animator">
    <meta name="tags" content="动画">
    <meta name="tags" content="插值器">
    <meta name="tags" content="interpolator">
    <meta name="tags" content="animation">




<!-- Open Graph -->
<meta property="og:site_name" content="Ambertime"/>
<meta property="og:title" content="Android 动画分析"/>
<meta property="og:description" content="Android 的动画分为以下两类 : View 动画 补间动画 (Tween Animation, Animation 类及其子类 ): 通过对 view 不断的作 rotate, scale, translate 等一系列操作从而达到动画效果 , xml 文件放在..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./android-dong-hua-fen-xi.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-05-01 00:00:00+08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="./author/ivicel.html">
<meta property="article:section" content="Android"/>
<meta property="article:tag" content="animator"/>
<meta property="article:tag" content="动画"/>
<meta property="article:tag" content="插值器"/>
<meta property="article:tag" content="interpolator"/>
<meta property="article:tag" content="animation"/>
<meta property="og:image" content="./theme/images/post-bg.jpg">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Android 动画分析",
  "headline": "Android 动画分析",
  "datePublished": "2018-05-01 00:00:00+08:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "ivicel",
    "url": "./author/ivicel.html"
  },
  "image": "./theme/images/post-bg.jpg",
  "url": "./android-dong-hua-fen-xi.html",
  "description": "Android 的动画分为以下两类 : View 动画 补间动画 (Tween Animation, Animation 类及其子类 ): 通过对 view 不断的作 rotate, scale, translate 等一系列操作从而达到动画效果 , xml 文件放在..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="blog-header" >
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="./" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Android 动画分析</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="./author/ivicel.html">Ivicel</a>
            | <time datetime="Tue 01 May 2018">Tue 01 May 2018</time>
        </span>
        <!-- TODO : Modified check -->
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
<div class="col-lg-3 hidden-xs hidden-sm">
    <div id="toc"><ul><li><a class="toc-href" href="#" title="Android 动画分析">Android 动画分析</a><ul><li><a class="toc-href" href="#1-tween-animation" title="1. 补间动画(Tween Animation)">1. 补间动画(Tween Animation)</a></li><li><a class="toc-href" href="#2-frame-animation" title="2. 帧动画(Frame Animation)">2. 帧动画(Frame Animation)</a></li><li><a class="toc-href" href="#3-property-animation" title="3. 属性动画(Property Animation)">3. 属性动画(Property Animation)</a></li><li><a class="toc-href" href="#4" title="4. 属性动画的监听器">4. 属性动画的监听器</a></li><li><a class="toc-href" href="#5-interpolator" title="5. 插值器(Interpolator)">5. 插值器(Interpolator)</a></li><li><a class="toc-href" href="#6-typeevaluator" title="6. 估值器(TypeEvaluator)">6. 估值器(TypeEvaluator)</a></li><li><a class="toc-href" href="#reference" title="Reference:">Reference:</a></li></ul></li></ul></div>
</div>
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>Android 的动画分为以下两类 :</p>
<ol>
<li>View 动画 </li>
<li> 补间动画 (Tween Animation, <code>Animation</code> 类及其子类 ): 通过对 view 不断的作 rotate, scale, translate 等一系列操作从而达到动画效果 , xml 文件放在 <code>res/anim/</code> 目录中 </li>
<li> 帧动画 (Frame Animation, <code>AnimationDrawable</code> 类 ): 通过播放一系列预先生成好的图片达到的动画效果 , 像电影胶片一样 , 因为是不断的更换图片 , 容易产生 OOM, xml 文件放在 <code>res/drawable/</code> 目录中 </li>
<li> 属性动画 (Property Animation): 通过不断的改变 view 的各种属性而达到动画效果 ,  帧动画存放在 <code>res/animator/</code> 中 </li>
</ol>
<p> 动画的定义可以由 xml 格式来定义 , 也可以直接在 java 代码中直接生成 . 然后在对应的 view 里调用动画的 start 方法 </p>
<h3 id="1-tween-animation">1. 补间动画 (Tween Animation)</h3>
<p> 补间动画一共有 4 个动画方式 , 对应 <code>Animation</code> 类下的 4 个子类 , 也可以用 xml 格式来定义动画 </p>
<ul>
<li> 平移标签 <code>&lt;translate&gt;</code>, 对应类 <code>TranslateAnimation</code></li>
<li> 缩放标签 <code>&lt;scale&gt;</code>, 对应类 <code>ScaleAnimation</code></li>
<li> 旋转标签 <code>&lt;rotate&gt;</code>, 对应类 <code>RotateAnimation</code></li>
<li> 透明度标签 <code>&lt;alpha&gt;</code>, 对应类 <code>AlphaAnimation</code></li>
</ul>
<blockquote>
<p> 在 drawable 中也有 scale, rotate 标签 , 不过存放目录不同 , 生成的 java 类也是不同 (Drawable).</p>
</blockquote>
<pre class="highlight"><code class="language-xml linenums">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;set xmlns:android="http://schemas.android.com/apk/res/android"
    android:interpolator="@[package:]anim/interpolator_resource"
    android:shareInterpolator=["true" | "false"] &gt;
    &lt;alpha
        android:fromAlpha="float"
        android:toAlpha="float" /&gt;
    &lt;scale
        android:fromXScale="float"
        android:toXScale="float"
        android:fromYScale="float"
        android:toYScale="float"
        android:pivotX="float"
        android:pivotY="float" /&gt;
    &lt;translate
        android:fromXDelta="float"
        android:toXDelta="float"
        android:fromYDelta="float"
        android:toYDelta="float" /&gt;
    &lt;rotate
        android:fromDegrees="float"
        android:toDegrees="float"
        android:pivotX="float"
        android:pivotY="float" /&gt;
    &lt;set&gt;
        ...
    &lt;/set&gt;
&lt;/set&gt;</code></pre>
<ul>
<li><code>&lt;set&gt;</code> 代表一个动画组 , 可以包括单个 / 多个动画 , 或者包含其他动画组 . 对应类 <code>AnimationSet</code></li>
<li><code>android:interpolator</code> 插值器 . 本质上就是定义动画如何变化的数学函数 , 变化规律 </li>
<li><code>andorid:shareInterpolator</code> 是否在子组中共享插值器 . 不共享时子动画需要自己指定 </li>
<li><code>&lt;alpha&gt;</code> 淡入 / 淡出标签 </li>
<li><code>android:fromAlpha</code> 开始值 </li>
<li><code>android:toAlpha</code> 结束值 </li>
<li><code>&lt;scale&gt;</code> 缩放标签 </li>
<li><code>android:fromXScale</code> 横坐标开始值 </li>
<li><code>android:toXScale</code> 横坐标结束值 </li>
<li><code>android:fromYScale</code> 纵坐标开始值 </li>
<li><code>andorid:toYScale</code> 纵坐标结束值 </li>
<li><code>android:pivotX</code> 缩放中心的 x 坐标 </li>
<li><code>android:pivotY</code> 缩放中心的 y 坐标 </li>
<li><code>&lt;translate&gt;</code> 平移标签 </li>
<li><code>android:fromXDelta</code> x 起始位置 </li>
<li><code>android:toXDelta</code> x 结束位置 </li>
<li><code>android:fromYDelta</code> y 起始位置 </li>
<li><code>android:toYDelta</code> y 结束位置 </li>
<li><code>rotate</code> 旋转标签 </li>
<li><code>android:fromDegrees</code> 旋转开始的角度 , 比如 0</li>
<li><code>android:toDegrees</code> 旋转结束的角度 , 比如 180</li>
<li><code>android:pivotX</code> 旋转的中心点横坐标 </li>
<li><code>android:pivotY</code> 旋转的中心点纵坐标 </li>
</ul>
<p> 通过 java 代码来启动动画 </p>
<pre class="highlight"><code class="language-java linenums">ImageView iv = findViewById(R.id.image_view);
Animation animation = AnimationUtils.loadAnimation(this, R.anim.my_animation);
// 另外还可以设置动画时间 , 动画完成后是否停留在结束位置
animation.setDuration(3000);
animation.setFillAfter(true);
iv.startAnimation(animation);</code></pre>
<h3 id="2-frame-animation">2. 帧动画 (Frame Animation)</h3>
<p> 帧动画比较简单 , 就是按规定的顺序来播放一系列的图片 . 需要注意的是避免加载过多尺寸较大的图片从而引起 OOM. <code>animation-list</code> 对应的是类 <code>AnimationDrawable</code>, 可以跟多个 item</p>
<pre class="highlight"><code class="language-xml linenums">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;animation-list xmlns:android="http://schemas.android.com/apk/res/android"
    android:oneshot=["true" | "false"] &gt;
    &lt;item
        android:drawable="@[package:]drawable/drawable_resource_name"
        android:duration="integer" /&gt;
&lt;/animation-list&gt;</code></pre>
<ul>
<li><code>android:oneshot</code> 是否只播放一次动画 </li>
<li><code>android:drawable</code> 图片来源 </li>
<li><code>andorid:duration</code> 图片播放时间 </li>
</ul>
<pre class="highlight"><code class="language-java linenums">ImageView rocketImage = findViewById(R.id.rocket_image);
rocketImage.setBackgroundResource(R.drawable.rockets);

AnimationDrawable rocketAnimation = (AnimationDrawable) rocketImage.getDrawable();
rocketAnimation.start();</code></pre>
<h3 id="3-property-animation">3. 属性动画 (Property Animation)</h3>
<p> 属性动画是 SDK 11 之后加入的特性 , 可以对任意的对象而不单单只是 view, 在一定的时间内 ( 默认 300ms) 把对象的属性从一个值变化到另一个值 . 所以属性动画几乎无所不能 . 属性动画对应的类为 <code>Animator</code>, 资源文件存在 <code>res/animator/</code> 中 </p>
<pre class="highlight"><code class="language-xml linenums">&lt;set
  android:ordering=["together" | "sequentially"]&gt;
    &lt;objectAnimator
        android:propertyName="string"
        android:duration="int"
        android:valueFrom="float | int | color"
        android:valueTo="float | int | color"
        android:startOffset="int"
        android:repeatCount="int"
        android:repeatMode=["repeat" | "reverse"]
        android:valueType=["intType" | "floatType"]/&gt;

    &lt;animator
        android:duration="int"
        android:valueFrom="float | int | color"
        android:valueTo="float | int | color"
        android:startOffset="int"
        android:repeatCount="int"
        android:repeatMode=["repeat" | "reverse"]
        android:valueType=["intType" | "floatType"]/&gt;

    &lt;set&gt;
        ...
    &lt;/set&gt;
&lt;/set&gt;</code></pre>
<ul>
<li>
<p><code>&lt;set&gt;</code> 动画合集 , 对应 <code>AnimatorSet</code> 类 , 可以包含 <code>&lt;objectAnimator&gt;</code>, <code>&lt;animator&gt;</code>, <code>&lt;set&gt;</code> 等 . 如果是子 set, 可以有自己的 <code>android:ordering</code></p>
</li>
<li>
<p><code>andorid:ordering</code> 动画的播放顺序 . <code>together</code> 默认 , 同时播放 ; <code>sequentially</code> 按顺序播放 </p>
</li>
<li>
<p><code>&lt;objectAnimator&gt;</code> 可定义任意对象的属性动画 , 对应 <code>ObjectAnimator</code> 类 . </p>
</li>
<li>
<p><code>android:propertyName</code> 属性名 , 比如 "alpha", "backgroundColor", 必须值 . 定义之后 , 类会通过反射去找对象时对应属性的 getter/setter 方法 </p>
</li>
<li><code>android:duration</code> 动画播放时间 </li>
<li><code>andorid:valueFrom</code> 开始值 </li>
<li><code>android:valueTo</code> 结束值 </li>
<li><code>android:valueType</code> 值的类型 . 默认 <code>floatType</code>, 整型 <code>intType</code></li>
</ul>
<blockquote>
<p> 注意开始 , 结束值默认是 float 浮点值 , 如果是颜色值也是用 float, 如果是 int 型 , 需要自己手动设置 </p>
</blockquote>
<ul>
<li><code>android:startOffset</code> 调用 <code>ObjectAnimator#start()</code> 延迟多少毫秒后开始 </li>
<li><code>android:repeatCount</code> 重复多少次 . <code>-1</code> 表示无限重复 . 默认 <code>0</code> 表示只播放一次 . <code>n</code> 表示一共播放 <code>n + 1</code>  次 </li>
<li>
<p><code>android:repeatMode</code> 重复播放时的模式 . <code>repeat</code> 总是从头开头播放 . <code>reverse</code> 反转播放 , 头 -&gt; 尾 -&gt; 头 -&gt; 尾 &hellip;. 这样的方式 </p>
</li>
<li>
<p><code>&lt;animator&gt;</code> 可定义在一个指完时间内完成一系列动画 . 对应类 <code>ValueAnimator</code>. 由于 <code>ObjectAnimator</code> 就是继承的 <code>ValueAnimator</code> 类 , 所以 animator 中定义的值的意思是一样 .</p>
</li>
</ul>
<p> 对于一个定义好的 xml, 可以使用 java 代码来启动动画 </p>
<pre class="highlight"><code class="language-java linenums">AnimatorSet as = (AnimatorSet) AnimatorInflater.loadAnimator(myContext, R.animator.property_animator);
as.setTarget(myObject);
as.start();</code></pre>
<h3 id="4">4. 属性动画的监听器 </h3>
<p> 属性动画主要有两个监听器 </p>
<pre class="highlight"><code class="language-java linenums">public interface AnimatorUpdateListener {
    // 开始 , 结束 , 取消 , 重复时调用
    void onAnimationStart(Animator animator);
    void onAnimationEnd(Animator animator);
    void onAnimationCancel(Animator animator);
    void onAnimationRepeat(Animator animator);
}

public interface AnimatorListener {
    // 动画播放每一帧时调用 , 即是每一次值改变时调用
    // 这个有时会对一些没有 getter/setter 方法的属性有特别用处 , 比如想设置从 0~100 的宽度
    // 可以设置成 0~100 的值变化 , 然后在值每次变化时的回调 , 更改其宽度
    void onAnimationUpdate(ValueAnimator animation);
}</code></pre>
<h3 id="5-interpolator">5. 插值器 (Interpolator)</h3>
<p> 插值器其实就是一类描述在指定时间内 ( 默认 300ms) 变化速率的函数 f(x), 其类都实现了 <code>android.view.animation.Interpolator</code> 接口 . 主要有以下几种 , 每个插值类都有对应的 xml 描述 . <code>getInterpolation</code> 方法返回的是一个百分比 .</p>
<pre class="highlight"><code class="language-java linenums">public interface Interpolator {
    abstract float getInterpolation(float input);   
}</code></pre>
<ul>
<li><code>AccelerateDecelerateInterpolator</code> 动画从开始到结束，变化率是先加速后减速的过程。</li>
<li><code>AccelerateInterpolator</code> 动画从开始到结束，变化率是一个加速的过程。</li>
<li><code>AnticipateInterpolator</code> 开始的时候向后，然后向前甩 </li>
<li><code>AnticipateOvershootInterpolator</code> 开始的时候向后，然后向前甩一定值后返回最后的值 </li>
<li><code>BounceInterpolator</code> 动画结束的时候弹起 </li>
<li><code>CycleInterpolator</code> 动画从开始到结束，变化率是循环给定次数的正弦曲线。</li>
<li><code>DecelerateInterpolator</code> 动画从开始到结束，变化率是一个减速的过程。</li>
<li><code>LinearInterpolator</code> 以常量速率改变 </li>
<li><code>OvershootInterpolator</code> 向前甩一定值后再回到原来位置 </li>
</ul>
<h3 id="6-typeevaluator">6. 估值器 (TypeEvaluator)</h3>
<p> 估值器是一个设置值变化的过程 , 其参数 fraction 为从 interpolator 接收来的变化百分比 , startValue 为初始值 , endValue 为最终值 , 返回计算后的结果 . 默认的有颜色 <code>ArgbEvaluator</code>, 浮点数 / 浮点数组 <code>FloatEvaluator</code>/<code>FloatArrayEvaluator</code>, 整型 / 整型数组 <code>IntEvaluator</code>/<code>IntArrayEvaluator</code>, 坐标 <code>PoinFEvaluator</code>, 矩形 <code>RectEvaluator</code>. 如果不是这些类型的变化 , 需要自己定义 , 只需要实现 TypeEvaluator</p>
<blockquote>
<p> 如果不实现 TypeEvaluator, 也可以在监听 Interpolator 的变化时做出值的改变 </p>
</blockquote>
<pre class="highlight"><code class="language-java linenums">public interface TypeEvaluator&lt;T&gt; {
    public T evaluate(float fraction, T starValue, T endValue);   
}</code></pre>
<h3 id="reference">Reference:</h3>
<ol>
<li><a href="https://developer.android.com/guide/topics/resources/animation-resource">https://developer.android.com/guide/topics/resources/animation-resource</a></li>
<li>&lt;<android 开发艺术探索 ="">&gt;</android></li>
</ol>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Android 动画分析&amp;url=./android-dong-hua-fen-xi.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=./android-dong-hua-fen-xi.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=./android-dong-hua-fen-xi.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="./tag/animator.html">animator</a><a href="./tag/dong-hua.html">动画</a><a href="./tag/cha-zhi-qi.html">插值器</a><a href="./tag/interpolator.html">interpolator</a><a href="./tag/animation.html">animation</a>                </aside>

                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">


          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script type="text/javascript" src="./theme/js/script.js"></script>

    <!-- Script specified by the user -->
    <script type="text/javascript"  src="./assets/js/prism.js"></script>
</body>
</html>